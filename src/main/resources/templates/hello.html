<!DOCTYPE html>
<html lang="en" xmlns:th="http://www.thymeleaf.org">
<head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <link rel="stylesheet" type="text/css" th:href="@{/css/bootstrap.css}"/>
    <script src="/js/jquery.js"></script>
    <script src="/js/bootstrap.js"></script>

    <link rel="shortcut icon" th:href="@{/images/favicon.ico}" />

    <title>XXX1大桥</title>
</head>

<body th:style="'background-image: url(/images/background.jpg)'">
<style>
    body{ font-family:"黑体"}
</style>


<div class="container" style="margin-top: 60px">
    <div>
        <label style="font-size: 20px; ">文件管理</label>
    </div>
    <form id="form1">
        <div class="form-group">
            <label for="excelfile">请选择excel:</label>
            <input type="file" name="file" id="excelfile" class="form-control" accept=".xlsx, .xls" style="width: 400px;"/>
        </div>
        <input type="submit" class="btn btn-primary" value="上传excel并保存"/>
    </form>

    <form id="formImg">
        <div class="form-group">
            <label for="imgfile">请选择图片:</label>
            <input type="file" name="file" id="imgfile" class="form-control" accept="image/*" style="width: 400px;"/>
        </div>
        <input type="submit" class="btn btn-primary" value="上传图片并保存"/>
    </form>

    <form action="/uploadExcelAndParse" method="POST" enctype="multipart/form-data">
        <div class="form-group">
            <label for="titleIndex">标题在第几行:</label>
            <input type="number" name="titleIndex" id="titleIndex" class="form-control" placeholder="请输入标题所在行数" style="width: 400px;"/>
        </div>
        <div class="form-group">
            <label for="colunmCounts">一共需要解析多少列:</label>
            <input type="number" name="colunmCounts" id="colunmCounts" class="form-control" placeholder="请输入列的数量" style="width: 400px;"/>
        </div>
        <div class="form-group">
            <label for="excelfile1" >请选择excel:</label>
            <input type="file" name="file" id="excelfile1" class="form-control" accept=".xlsx, .xls" style="width: 400px;"/>
        </div>
        <input type="submit" class="btn btn-primary" value="上传并解析excel"/>

        <script>
            var form1 = document.getElementById('form1');
            form1.addEventListener('submit', function(event) {
                event.preventDefault();// 这里可以添加代码处理表单数据
                // 比如使用 FormData 收集表单数据，或者使用 AJAX 异步提交表单
                var formData = new FormData(this);
                // 使用 AJAX 提交表单
                fetch('/uploadExcelAndSave', {
                    method: 'POST',
                    body: formData
                })
                    .then(response => response.json())
            .then(data => {
                    console.log(data);
                alert("excel save result:" + JSON.stringify(data));
            })
            .catch(error => console.error(error));
            });

            var formImg = document.getElementById('formImg');
            formImg.addEventListener('submit', function(event) {
                event.preventDefault();// 这里可以添加代码处理表单数据
                // 比如使用 FormData 收集表单数据，或者使用 AJAX 异步提交表单
                var formData = new FormData(this);
                // 使用 AJAX 提交表单
                fetch('/uploadImgAndSave', {
                    method: 'POST',
                    body: formData
                })
                    .then(response => response.json())
            .then(data => {
                    console.log(data);
                alert("excel save result:" + JSON.stringify(data));
            })
            .catch(error => console.error(error));
            });

        </script>
    </form>



</div>

</body>
</html>